# Candidate Data Workflow Automation with Python & Excel

![Python](https://img.shields.io/badge/python-3.10%2B-blue.svg)  
![License](https://img.shields.io/badge/license-MIT-lightgrey)  
[![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/gmarchiello/Candidate-Data-Workflow-Automation/blob/main/colab/Candidate-Data-Workflow-Automation_colab.ipynb)

---

## 🔍 About This Project
This repository contains a **mockup version** of a tool I originally developed at *Instituto Cervantes* to streamline candidate data updates.

Previously, updating candidate information required **manually filling PDF forms** and sending them via JIRA — a process that was **time-consuming, repetitive, and prone to errors**, especially during peak exam periods.

This project demonstrates a **semi-automated workflow**: it automates the repetitive core tasks while allowing **flexible manual handling** for cases where requests arrive via calls, emails, texts, or require special attention.
---

## 🚀 Try It Online
You can run the **full workflow** directly in Google Colab — no installation needed.  
The Colab notebook handles all file setup automatically (downloads templates and Excel from GitHub, zips outputs) so you can simply **run all cells** to see the workflow in action.  

[![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/gmarchiello/Candidate-Data-Workflow-Automation/blob/main/colab/Candidate-Data-Workflow-Automation_colab.ipynb)

---

## 🔍 Workflow Overview

1. **Data Aggregation (Power Query):**  
   - Power Query collects all yearly Excel files from `raw_candidates/`.  
   - These files are combined into a **consolidated dataset** in `change_request_data/`.

2. **Request Handling:**  
   - Requests arrive via email, call, text, or other channels.  
   - You **manually select the relevant rows** in the consolidated Excel sheet.  
   - **Special case — email changes:** Enter the old and new email; the script automatically fetches all other candidate information using the old email as the primary key.

3. **PDF Generation (Python):**  
   - The Python script reads the selected rows.  
   - Validates all required fields.  
   - Fills the PDF forms (text fields and checkboxes).  
   - Saves PDFs in **timestamped folders** with safe filenames (`UNKNOWN` for missing names).  
   - Generates **email-ready summaries** for batch sending.

This workflow is **semi-automated**: repetitive tasks like PDF filling, logging, and output management are fully automated, while row selection remains **flexible and manual** to accommodate diverse request types.

---

## ⚡ Key Features
- **Excel / Power Query integration** — consolidates candidate data and allows flexible filtering.  
- **Automated PDF filling (Python)** — fills text fields and checkboxes based on Excel input.  
- **Output management** — timestamped folders, safe filenames (`"UNKNOWN"` if missing), and batch-ready email summaries.  
- **Logging & error handling** — shows success ✔️, missing text ⚠️, or missing checkboxes ❗; continues processing without stopping.  
- **Flexible workflow** — fully automated for email changes; manual filtering supported for other updates.

---

## 🛠️ Handling Missing Data
- **Missing Name / Surname** — PDF field left empty; filename uses `UNKNOWN` (e.g. `UNKNOWN_John_change_request.pdf`).  
- **Missing text fields** — PDF left blank; a warning is logged.  
- **Missing checkboxes** — PDF still generated; an alert is logged.  
- **Success cases** — rows logged with ✔️.

This approach favors **speed and flexibility**, letting you quickly fix edge cases manually rather than stopping the whole run.

---

## 📊 Impact
- ⏱️ **Time savings:** ~93% per candidate *(manual ~7.5 min → automated ~0.5 min)*  
  *Estimated from average processing times per candidate.*  
- ✅ **Error reduction:** automated validation reduces mistakes  
- 📈 **Scalability:** handles high-volume sessions without bottlenecks  
- 💡 **Flexibility:** continues running even with incomplete data.

---

## 📂 Project Structure
```
project_root/
├─ colab/                 # Google Colab notebook (ready-to-run version)
├─ src/
│  ├─ main.py             # Main execution pipeline
│  ├─ config.py           # Configuration and mappings
│  ├─ pdf_filler.py       # PDF form handling
│  └─ utils.py            # Helper functions
├─ input/
│  ├─ templates/          # PDF templates
│  ├─ raw_candidates/     # Excel files per year with candidate data
│  └─ change_request_data/# Consolidated Excel sheet generated by Power Query
│     # Power Query unions all yearly Excel files and prepares the dataset used by Python for PDF filling
├─ output/                # Generated PDFs (auto-created)
└─ requirements.txt       # Project dependencies
```

---

## 📦 Requirements
- Python 3.10+  
- `pandas`  
- `openpyxl`  
- `pdfrw`  
- `pytz`  

Install all dependencies:

```bash
pip install -r requirements.txt
````

---

## 🚀 Usage

1. Place the Excel input file in `input/change_request_data/`
2. Place the PDF template in `input/templates/`
3. Run the script:

```bash
python src/main.py
```

4. Check `/output/` for generated PDFs.
5. Review console logs for email-ready summaries.

---

## 🧑‍💻 Skills Demonstrated

* Python scripting & automation
* Data pipelines (Excel → Python → PDF)
* Error handling & logging
* Workflow optimization & process improvement
* Practical use of `pandas`, `openpyxl`, `pdfrw`
